<!DOCTYPE html>
<html>
<head>
 <title>选择下拉菜单</title>
 <meta http-equiv="Content-Type" content="text/html; charset=gb2312">
 <meta charset="UTF-8"></head>
<body>
<form method="post" name="myform">
 <table border="0" width="300">
  <tr>
   <td width="40%">
    <select style="WIDTH:100%" multiple name="list1" size="12" ondblclick="moveOption(document.myform.list1, document.myform.list2)">
     <option value="1">1</option>
     <option value="2">2</option>
     <option value="3">3</option>
     <option value="4">4</option>
     <option value="5">5</option>
     <option value="6">6</option>
     <option value="7">7</option>
     <option value="8">8</option>
     <option value="9">9</option>
     <option value="10">10</option>
    </select>
   </td>
   <td width="20%" align="center">
    <input type="button" value="添加" onclick="moveOption(document.myform.list1, document.myform.list2)"><br/>
    <br/>
    <input type="button" value="删除" onclick="moveOption(document.myform.list2, document.myform.list1)">
   </td>
   <td width="40%">
    <select style="WIDTH:100%" multiple name="list2" size="12" ondblclick="moveOption(document.myform.list2, document.myform.list1)">
    </select>
   </td>
   <td>
    <button onclick="changepos(list2,-1)" type="button">上移</button>
    <br/>
    <button onclick="changepos(list2,1)" type="button">下移</button>
   </td>
  </tr>
 </table>
 已有权限：<input type="text" name="city" size="40">
</form>
<script language="JavaScript">
 <!--
 function moveOption(e1, e2){
  try{
   for(var i=0;i<e1.options.length;i++){
    if(e1.options[i].selected){
     var e = e1.options[i];
     e2.options.add(new Option(e.text, e.value));
     e1.remove(i);
     ii=i-1
    }
   }
   document.myform.city.value=getvalue(document.myform.list2);
  }
  catch(e){}
 }
 function getvalue(geto){
  var allvalue = "";
  for(var i=0;i<geto.options.length;i++){
   allvalue +=geto.options[i].value + ",";
  }
  return allvalue;
 }
 function changepos(obj,index)
 {
  if(index==-1){
   if (obj.selectedIndex>0){
    obj.options(obj.selectedIndex).swapNode(obj.options(obj.selectedIndex-1))
   }
  }
  else if(index==1){
   if (obj.selectedIndex<obj.options.length-1){
    obj.options(obj.selectedIndex).swapNode(obj.options(obj.selectedIndex+1))
   }
  }
 }
 //-->
</script>
</body>
</html>
  